---
title: "Uma história em slides"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(plotly)
packageVersion('plotly')
theme_set(theme_bw())


respostas = read_csv(here::here("data/enade-ccc-2017.csv"),
                     col_types = "cccdccdddc")

cursos = respostas %>% 
    group_by(UF) %>% 
    summarise(n = n(), 
              media = mean(media))

criterios = respostas %>% 
    group_by(UF, categoria) %>% 
    summarise(media = mean(media))

```


### Parte 1

```{r}
r <- respostas %>% group_by(IES, UF, categoria, tema) %>% summarise(media = mean(media)) %>%  filter(categoria != "Outros" & categoria != "Aprendizagem além do técnico" & categoria != "Curso em geral")

p <- r %>%
  plot_ly(
    x = ~media, 
    y = ~tema,
    color = ~categoria, 
    frame = ~UF,
    text = ~IES,
    hoverinfo = "text",
    type = 'scatter',
    mode = 'markers'
  ) %>%
  layout(
    xaxis = list(
      type = "log"
    )
  )

ggplotly(p)
```

***

As categorias das questões foram divididas em 4: `Aprendizagem além do técnico`, `Curso em geral`, `Ensino, apoio e avaliacão`, `Infraestrutua` e `Outros`. Além disso, as questões também possuiam temas pertencentes às categorias citadas. Na visualização ao lado podemos ver qual a média das universidade para cada tema de acordo com as respostas. Separamos as universidades pelo seu estado, além disso, nesta primeira podemos observar apenas as categorias `Ensino, apoio e avaliacão` e `Infraestrutua`. Deslize o scroll para escolher qual estado você deseja observar.


### Parte 2
```{r}
r <- respostas %>% group_by(IES, UF, categoria, tema) %>% summarise(media = mean(media)) %>%  filter(categoria != "Outros" & categoria != "Infraestrutura" & categoria != "Ensino, apoio e avaliacão")

p <- r %>%
  plot_ly(
    x = ~media, 
    y = ~tema,
    color = ~categoria, 
    frame = ~UF,
    text = ~IES,
    hoverinfo = "text",
    type = 'scatter',
    mode = 'markers'
  ) %>%
  layout(
    xaxis = list(
      type = "log"
    )
  )

ggplotly(p)
```

***

Aqui temos outras duas categorias. Deixamos a categoria `Outros` de fora, pois algumas universidades não possuiam essa informação.


```{r}

ufcg <- respostas %>% filter(IES == "UFCG") %>%  group_by(categoria) %>% summarise(m = mean(media))
ufrj <- respostas %>% filter(IES == "UFRJ") %>%  group_by(categoria) %>% summarise(m = mean(media))

p <- plot_ly(
    type = 'scatterpolar',
    fill = 'toself'
  ) %>% 
  add_trace(
    r = ufcg$m,
    theta = ufcg$categoria,
    name = 'UFCG'
  ) %>% 
  add_trace(
    r = ufrj$m,
    theta = ufrj$categoria,
    name = 'UFRJ'
  ) %>%
  layout(
    polar = list(
      radialaxis = list(
        visible = T,
        range = c(0,6)
      )
    )
  )

# Create a shareable link to your chart
# Set up API credentials: https://plot.ly/r/getting-started

ggplotly(p)
```



***

A UFRJ é a universidade mais bem avaliada do Brasil, segundo site1 e site2.
Nos dados coletados, para as categorias apresentadas, Curso em Geral, Infraestrutura, Aprendizagem além do técnico, Ensino apoio e avaliação e Outros, suas médias são 4.46, 4.10, 4.16, 4.0 e 4.8 respectivamente. 



Resolvemos comparar uma das melhores universidades do país com a nossa, a UFCG. Ignorando a categoria `Outros`, pois a UFCG não tem perguntas que se encaixem na mesma, podemos observar que ela só se aproxima da UFRJ na categoria de Infraestrutura, o que faz sentido, já que estamos na 15a colocação do Brasil. 

### Parte 2

```{r}
cursos %>% 
    ggplot(aes(x = UF, y = media)) + 
    geom_col() + 
    coord_flip()
```

*** 

Comentário do Frame 2.


### Parte 3

```{r}
cursos %>% 
    ggplot(aes(x = UF, y = n)) + 
    geom_col()
```

*** 

Mais um comentário
